/* A list of NBA Western Conference teams and their win percentages */
CREATE TABLE teams (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    location TEXT,
    name TEXT,
    win_percentage INTEGER)
    ;
    
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Dallas", "Mavericks", .575);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Denver", "Nuggets", .667);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Golden State", "Warriors", .600);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Houston", "Rockets", .256);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Los Angeles", "Clippers", .512);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Los Angeles", "Lakers", .475);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Memphis", "Grizzlies", .658);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Minnesota", "Timberwolves", .475);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("New Orleans", "Pelicans", .600);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Oklahoma City", "Thunder", .436);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Phoenix", "Suns", .500);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Portland", "Trailblazers", .500);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Sacramento", "Kings", .526);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("San Antonio", "Spurs", .325);
INSERT INTO teams (location, name, win_percentage) 
VALUES ("Utah", "Jazz", .476);

/* A list of the top 3 players from each team based on BPM, min 400 minutes played */
CREATE TABLE players (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    team_id INTEGER,
    name TEXT,
    position TEXT,
    bpm INTEGER)
    ;

INSERT INTO players (team_id, name, position, bpm) 
VALUES (8, "Kyle Anderson", "PF", 1.0);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (7, "Desmond Bane", "SG", 2.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (5, "Nicolas Batum", "PF", 1.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (11, "Devin Booker", "SG", 4.0);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (2, "Bruce Brown", "PG", 0.1);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (6, "Thomas Bryant", "C", 2.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (14, "Zach Collins", "PF", -1.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (3, "Stephen Curry", "PG", 9.4);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (6, "Anthony Davis", "C", 8.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (1, "Spencer Dinwiddie", "PG", 0.8);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (1, "Luka Dončić", "PG", 10.9);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (12, "Drew Eubanks", "C", 1.1);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (13, "De'Aaron Fox", "PG", 2.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (4, "Usman Garuba", "PF", 0.0);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (5, "Paul George", "SF", 3.5);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (10, "Shai Gilgeous-Alexander", "SG", 6.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (2, "Aaron Gordon", "PF", 2.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (12, "Jerami Grant", "PF", 2.0);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (13, "Kevin Huerter", "SG", 0.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (9, "Brandon Ingram", "SF", 1.9);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (7, "Jaren Jackson Jr.", "C", 4.9);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (6, "Lebron James", "PF", 5.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (10, "Isaiah Joe", "SG", 3.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (11, "Cameron Johnson", "PF", 4.0);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (2, "Nicola Jokić", "C", 12.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (15, "Walker Kessler", "C", 1.7);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (5, "Kawhi Leonard", "SF", 2.6);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (12, "Damian Lillard", "PG", 4.7);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (3, "Kevon Looney", "C", 2.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (15, "Lauri Markkanen", "PF", 4.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (7, "Ja Morant", "PG", 6.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (9, "Larry Nance Jr.", "PF", 2.5);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (11, "Chris Paul", "PG", 2.7);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (14, "Jakob Poeltl", "PF", 1.5);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (10, "Aleksej Pokusevski", "PF", 0.4);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (4, "Kevin Porter Jr.", "PG", -0.3);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (8, "Naz Reid", "C", 1.1);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (13, "Domantas Sabonis", "PF", 6.5);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (4, "Alperen Sengün", "C", 1.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (8, "Karl-Anthony Towns", "PF", 3.2);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (15, "Jarred Vanderbilt", "PF", 1.7);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (14, "Devin Vassell", "SG", 1.1);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (3, "Andrew Wiggins", "SF", 1.8);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (9, "Zion Williamson", "PF", 5.9);
INSERT INTO players (team_id, name, position, bpm) 
VALUES (1, "Christian Wood", "PF", 2.1);

/* Directly comparing the highest BPM players on each team with their win percentage */
SELECT players.name, 
    MAX(players.bpm), 
    teams.name, 
    teams.win_percentage 
FROM teams
JOIN players
ON players.team_id = teams.id
GROUP BY teams.name
ORDER BY players.bpm
DESC;

/* Isolating the teams with winning records */
SELECT players.name, 
    MAX(players.bpm), 
    teams.name, 
    teams.win_percentage 
FROM teams
JOIN players
ON players.team_id = teams.id
WHERE teams.win_percentage > 0.501
GROUP BY teams.name
ORDER BY teams.win_percentage
DESC;

/* Comparing the players with the highest BPM at their position with their respective teams winning percentages*/
SELECT players.position, 
    players.name, 
    MAX(players.bpm), 
    teams.win_percentage 
FROM teams
JOIN players
ON players.team_id = teams.id
GROUP BY players.position
ORDER BY players.bpm
DESC;

/* Showing correlation between win percentages based on BPM of centers */
SELECT players.name, 
    players.bpm, 
    teams.name, 
    teams.win_percentage 
FROM teams
JOIN players
ON players.team_id = teams.id
WHERE players.position = "C"
ORDER BY players.bpm
DESC;

/* Showing which teams top 3 players have the highest combined BPM and seeing how it relates to wins */
SELECT teams.name, 
    teams.win_percentage, 
    ROUND(SUM(players.bpm),2) AS team_bpm
FROM teams
JOIN players
ON players.team_id = teams.id
GROUP BY teams.name
ORDER by team_bpm
DESC;
